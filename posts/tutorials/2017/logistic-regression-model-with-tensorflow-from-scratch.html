<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>ä»é›¶å¼€å§‹ä½¿ç”¨TensorFlowå»ºç«‹ç®€å•çš„é€»è¾‘å›å½’æ¨¡å‹ | Wonderland</title>
    <meta name="description" content="Personal blog home">
    <link rel="stylesheet" href="/assets/style.ec68298c.css">
    <link rel="modulepreload" href="/assets/chunks/_virtual_mermaid-config.111929ab.js">
    <link rel="modulepreload" href="/assets/chunks/Valine.min.5ef8960e.js">
    <link rel="modulepreload" href="/assets/app.7001bd85.js">
    <link rel="modulepreload" href="/assets/posts_tutorials_2017_logistic-regression-model-with-tensorflow-from-scratch.md.8cc97dee.lean.js">
    
    <meta name="author" content="dyzdyz010">
  <meta property="og:title" content="Home">
  <meta property="og:description" content="Personal blog home">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.3/dist/katex.min.css">
  <meta name="twitter:title" content="ä»é›¶å¼€å§‹ä½¿ç”¨TensorFlowå»ºç«‹ç®€å•çš„é€»è¾‘å›å½’æ¨¡å‹ | Wonderland">
  </head>
  <body>
    <div id="app"><div class="flex flex-col h-screen"><nav data-headlessui-state class="navbar border border-x-0 border-t-0 border-b-gray-200 z-[100]"><div class="mx-auto px-2 sm:px-6 lg:px-8"><div class="relative flex items-center justify-between h-16"><div class="absolute inset-y-0 right-0 flex items-center sm:hidden"><button id="headlessui-disclosure-button-129" type="button" aria-expanded="false" data-headlessui-state class="inline-flex items-center justify-center p-2 text-gray-700 hover:text-sky-700 focus:outline-none"><span class="sr-only">Open main menu</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" aria-hidden="true" class="block h-6 w-6"><path stroke-linecap="round" stroke-linejoin="round" d="M4 6h16M4 12h16M4 18h16"></path></svg></button></div><div class="flex-1 flex sm:items-stretch justify-center sm:justify-start"><div class="flex-shrink-0 flex mr-10 items-center"><a href="/" class=""><img class="justify-center lg:inline h-8 w-auto" src="/blog_logo.png" alt="Logo"></a><a href="/" class="text-xl font-bold text-gray-700 hover:text-sky-700 rounded-md hidden md:inline ml-2">Wonderland</a></div><div class="hidden sm:block ml-auto"><div class="flex-1 flex space-x-1 justify-end"><!--[--><div class="px-3 py-2 inline-flex"><a href="/" class="text-gray-500 hover:text-sky-700 text-base font-bold"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="inline-block w-5 h-5 mr-1"><path d="M10.707 2.293a1 1 0 00-1.414 0l-7 7a1 1 0 001.414 1.414L4 10.414V17a1 1 0 001 1h2a1 1 0 001-1v-2a1 1 0 011-1h2a1 1 0 011 1v2a1 1 0 001 1h2a1 1 0 001-1v-6.586l.293.293a1 1 0 001.414-1.414l-7-7z"></path></svg><span>Home</span></a></div><div class="px-3 py-2 inline-flex"><a href="/tags" class="text-gray-500 hover:text-sky-700 text-base font-bold"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="inline-block w-5 h-5 mr-1"><path fill-rule="evenodd" d="M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a3 3 0 013-3h5c.256 0 .512.098.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path></svg><span>Tags</span></a></div><div class="px-3 py-2 inline-flex"><div data-headlessui-state class="ml-3 relative"><div><button id="headlessui-menu-button-131" type="button" aria-haspopup="true" aria-expanded="false" data-headlessui-state class="text-gray-500 hover:text-sky-700 focus:outline-none text-base font-bold"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="inline-block w-5 h-5"><path d="M7 3a1 1 0 000 2h6a1 1 0 100-2H7zM4 7a1 1 0 011-1h10a1 1 0 110 2H5a1 1 0 01-1-1zM2 11a2 2 0 012-2h12a2 2 0 012 2v4a2 2 0 01-2 2H4a2 2 0 01-2-2v-4z"></path></svg> Collections <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="inline-block w-5 h-5"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"></path></svg></button></div><!----></div></div><div class="px-3 py-2 inline-flex"><a href="/about" class="text-gray-500 hover:text-sky-700 text-base font-bold"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="inline-block w-5 h-5 mr-1"><path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-3a1 1 0 00-.867.5 1 1 0 11-1.731-1A3 3 0 0113 8a3.001 3.001 0 01-2 2.83V11a1 1 0 11-2 0v-1a1 1 0 011-1 1 1 0 100-2zm0 8a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path></svg><span>About</span></a></div><!--]--></div></div></div></div></div><!----></nav><div class="flex flex-col lg:container lg:mx-auto mt-10 mb-20"><!--[--><div class="md:mx-32 md:mt-20 mx-2"><div class="post-title"><h1 class="block text-4xl font-bold mb-5 text-gray-700">ä»é›¶å¼€å§‹ä½¿ç”¨TensorFlowå»ºç«‹ç®€å•çš„é€»è¾‘å›å½’æ¨¡å‹</h1><div class="flex flex-row flex-wrap font-medium text-gray-500"><span class="mr-4 lg:mr-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="inline-block w-4 h-4 mr-2 mb-[0.1rem]"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm1-12a1 1 0 10-2 0v4a1 1 0 00.293.707l2.828 2.829a1 1 0 101.415-1.415L11 9.586V6z" clip-rule="evenodd"></path></svg><span>Tue, Jun 27, 2017</span></span><span class="hidden lg:inline-block md:mx-5">|</span><span class="mr-4 lg:mr-0"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="inline-block w-4 h-4 mr-2 mb-[0.1rem]"><path fill-rule="evenodd" d="M10 9a3 3 0 100-6 3 3 0 000 6zm-7 9a7 7 0 1114 0H3z" clip-rule="evenodd"></path></svg><span>dyzdyz010</span></span><span class="hidden lg:inline-block md:mx-5">|</span><span class="break-words"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="inline-block w-4 h-4 mr-2 mb-[0.1rem]"><path fill-rule="evenodd" d="M17.707 9.293a1 1 0 010 1.414l-7 7a1 1 0 01-1.414 0l-7-7A.997.997 0 012 10V5a3 3 0 013-3h5c.256 0 .512.098.707.293l7 7zM5 6a1 1 0 100-2 1 1 0 000 2z" clip-rule="evenodd"></path></svg><!--[--><span class="mr-2 hover:text-sky-700 cursor-pointer">ml</span><span class="mr-2 hover:text-sky-700 cursor-pointer">code</span><span class="mr-2 hover:text-sky-700 cursor-pointer">python</span><span class="mr-2 hover:text-sky-700 cursor-pointer">tensorflow</span><!--]--></span></div></div><div class="post mt-16"><div style="position:relative;"><div><p>TensorFlow æ˜¯ä¸€ä¸ªåŸºäº python çš„æœºå™¨å­¦ä¹ æ¡†æ¶ã€‚åœ¨ Coursera ä¸Šå­¦ä¹ äº†é€»è¾‘å›å½’çš„è¯¾ç¨‹å†…å®¹åï¼Œæƒ³æŠŠåœ¨ MATLAB ä¸­å®ç°äº†çš„å†…å®¹ç”¨ TensorFlow é‡æ–°å®ç°ä¸€éï¼Œå½“åšå­¦ä¹  Python å’Œæ¡†æ¶çš„æ•²é—¨ç –ã€‚</p><h3 id="ç›®æ ‡è¯»è€…" tabindex="-1">ç›®æ ‡è¯»è€… <a class="header-anchor" href="#ç›®æ ‡è¯»è€…" aria-hidden="true">#</a></h3><p>çŸ¥é“é€»è¾‘å›å½’æ˜¯ä»€ä¹ˆï¼Œæ‡‚ä¸€ç‚¹ Pythonï¼Œå¬è¯´è¿‡ TensorFlow</p><h3 id="æ•°æ®é›†" tabindex="-1">æ•°æ®é›† <a class="header-anchor" href="#æ•°æ®é›†" aria-hidden="true">#</a></h3><p>æ¥è‡ª Coursera ä¸Š Andrew çš„æœºå™¨å­¦ä¹ è¯¾ç¨‹ä¸­çš„<code>ex2data1.txt</code>ï¼Œæ ¹æ®å­¦ç”Ÿçš„ä¸¤æ¬¡è€ƒè¯•æˆç»©åˆ¤æ–­è¯¥å­¦ç”Ÿæ˜¯å¦ä¼šè¢«å½•å–ã€‚</p><h3 id="ç¯å¢ƒ" tabindex="-1">ç¯å¢ƒ <a class="header-anchor" href="#ç¯å¢ƒ" aria-hidden="true">#</a></h3><p>Python 2.7 - 3.x</p><p>pandas, matplotlib, numpy</p><h3 id="å®‰è£…-tensorflow" tabindex="-1">å®‰è£… TensorFlow <a class="header-anchor" href="#å®‰è£…-tensorflow" aria-hidden="true">#</a></h3><p>åœ¨è‡ªå·±çš„ç”µè„‘ä¸Šå®‰è£… TensorFlow æ¡†æ¶ï¼Œå®‰è£…æ–¹æ³•è¿‡ç¨‹ä¸èµ˜è¿°ï¼ŒCPU ç‰ˆç›¸å¯¹æ›´å®¹æ˜“ä¸€ç‚¹ï¼ŒGPU ç‰ˆéœ€è¦ CUDA æ”¯æŒï¼Œå„ä½çœ‹å®˜çœ‹æƒ…å†µå®‰è£…å°±å¥½ã€‚</p><h3 id="å¼€å§‹" tabindex="-1">å¼€å§‹ <a class="header-anchor" href="#å¼€å§‹" aria-hidden="true">#</a></h3><p>åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼ˆæ¯”å¦‚å°±å«åš<code>tensorflow</code>ï¼‰ï¼Œåœ¨æ–‡ä»¶å¤¹ä¸­åˆ›å»ºä¸€ä¸ª Python æ–‡ä»¶<code>main.py</code>ï¼Œå¹¶å°†æ•°æ®é›†æ–‡ä»¶æ”¾åˆ°è¿™ä¸ªæ–‡ä»¶å¤¹ä¸‹ï¼š</p><p><img src="https://ws4.sinaimg.cn/large/006tKfTcly1fgzhzjoe5mj30fg042dfz.jpg" alt=""></p><p>æ•°æ®å½¢å¼:</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcly1fgzv7030poj30j407q75z.jpg" alt=""></p><p>å‰ä¸¤åˆ—åˆ†åˆ«ä¸ºä¸¤æ¬¡è€ƒè¯•æˆç»©ï¼ˆx1, x2ï¼‰ï¼Œæœ€åä¸€åˆ—ä¸ºæ˜¯å¦è¢«å½•å–ï¼ˆyï¼‰ï¼Œ<code>1</code>ä»£è¡¨è¢«å½•å–ï¼Œ<code>0</code>åˆ™åä¹‹ã€‚</p><p>åœ¨æºæ–‡ä»¶<code>main.py</code>ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå¼•å…¥éœ€è¦çš„åŒ…ï¼š</p><div class="language-python"><pre><code><span class="token keyword">import</span> pandas <span class="token keyword">as</span> pd                <span class="token comment"># ç”¨äºè¯»å–æ•°æ®æ–‡ä»¶</span>
<span class="token keyword">import</span> tensorflow <span class="token keyword">as</span> tf
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt    <span class="token comment"># ç”¨äºç”»å›¾</span>
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np                 <span class="token comment"># ç”¨äºåç»­è®¡ç®—</span>
</code></pre></div><p><code>pandas</code>æ˜¯ä¸€ä¸ªæ•°æ®å¤„ç†ç›¸å…³çš„åŒ…ï¼Œå¯ä»¥å¯¹æ•°æ®é›†è¿›è¡Œè¯»å–å’Œå…¶ä»–å„ç§æ“ä½œï¼›<code>matplotlib</code>å¯ä»¥ç”¨æ¥æŠŠæˆ‘ä»¬çš„æ•°æ®é›†ç»˜æˆå›¾è¡¨å±•ç¤ºå‡ºæ¥ã€‚</p><p>æ¥ç€æˆ‘ä»¬å°†æ•°æ®é›†æ–‡ä»¶è¯»å…¥ç¨‹åºï¼Œç”¨äºåé¢çš„è®­ç»ƒï¼š</p><div class="language-python"><pre><code><span class="token comment"># è¯»å–æ•°æ®æ–‡ä»¶</span>
df <span class="token operator">=</span> pd<span class="token punctuation">.</span>read_csv<span class="token punctuation">(</span><span class="token string">&quot;ex2data1.txt&quot;</span><span class="token punctuation">,</span> header<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span>
train_data <span class="token operator">=</span> df<span class="token punctuation">.</span>values
</code></pre></div><p><code>pandas</code>å‡½æ•°<code>read_csv</code>å¯ä»¥å°† csvï¼ˆcomma-separated valuesï¼‰æ–‡ä»¶ä¸­çš„æ•°æ®è¯»å…¥<code>df</code>å˜é‡ï¼Œé€šè¿‡<code>df.values</code>å°† DataFrame è½¬åŒ–ä¸ºäºŒç»´æ•°ç»„ï¼š</p><p><img src="https://ws3.sinaimg.cn/large/006tKfTcly1fgzvpetjf7j30me0a4myp.jpg" alt=""></p><p>æœ‰äº†æ•°æ®ä¹‹åï¼Œæˆ‘ä»¬éœ€è¦å°†ç‰¹å¾ï¼ˆx1, x2ï¼‰å’Œæ ‡ç­¾ï¼ˆyï¼‰åˆ†åˆ«æ”¾åˆ°ä¸¤ä¸ªå˜é‡ä¸­ï¼Œä»¥ä¾¿åœ¨è®­ç»ƒä¸­ä»£å…¥å…¬å¼ï¼š</p><div class="language-python"><pre><code><span class="token comment"># åˆ†ç¦»ç‰¹å¾å’Œæ ‡ç­¾ï¼Œå¹¶è·å–æ•°æ®ç»´æ•°</span>
train_X <span class="token operator">=</span> train_data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span>
train_y <span class="token operator">=</span> train_data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
feature_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>train_X<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
sample_num <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>train_X<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Size of train_X: {}x{}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>sample_num<span class="token punctuation">,</span> feature_num<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">&quot;Size of train_y: {}x{}&quot;</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>train_y<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">len</span><span class="token punctuation">(</span>train_y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p><img src="https://ws1.sinaimg.cn/large/006tKfTcly1fgzvtaekpuj309c01k0st.jpg" alt=""></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬çš„æ•°æ®é›†ä¸­æœ‰100æ¡æ ·ä¾‹ï¼Œæ¯æ¡æ ·ä¾‹çš„ç‰¹å¾æ•°é‡ä¸º2ã€‚</p><h3 id="tensorflow-æ¨¡å‹è®¾è®¡" tabindex="-1">TensorFlow æ¨¡å‹è®¾è®¡ <a class="header-anchor" href="#tensorflow-æ¨¡å‹è®¾è®¡" aria-hidden="true">#</a></h3><p>åœ¨é€»è¾‘å›å½’ä¸­ï¼Œæˆ‘ä»¬ä½¿ç”¨çš„é¢„æµ‹å‡½æ•°ï¼ˆHypothesisï¼‰ä¸ºï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><msub><mi>h</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><mi>x</mi><mo stretchy="false">)</mo><mo>=</mo><mi>s</mi><mi>i</mi><mi>g</mi><mi>m</mi><mi>o</mi><mi>i</mi><mi>d</mi><mo stretchy="false">(</mo><mi>X</mi><mi>W</mi><mo>+</mo><mi>b</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">h_Î¸(x) = sigmoid(XW + b) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord mathnormal">x</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">s</span><span class="mord mathnormal">i</span><span class="mord mathnormal" style="margin-right:0.03588em;">g</span><span class="mord mathnormal">m</span><span class="mord mathnormal">o</span><span class="mord mathnormal">i</span><span class="mord mathnormal">d</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.07847em;">X</span><span class="mord mathnormal" style="margin-right:0.13889em;">W</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal">b</span><span class="mclose">)</span></span></span></span></span></p><p>å…¶ä¸­ï¼Œ<code>sigmoid</code>æ˜¯ä¸€ä¸ª<code>æ¿€æ´»å‡½æ•°</code>ï¼Œåœ¨è¿™é‡Œè¡¨ç¤ºå­¦ç”Ÿè¢«å½•å–çš„æ¦‚ç‡ï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>P</mi><mo stretchy="false">(</mo><mi>y</mi><mo>=</mo><mn>1</mn><mi mathvariant="normal">âˆ£</mi><mi>x</mi><mo separator="true">,</mo><mi>Î¸</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">P(y = 1 | x, \theta) </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1âˆ£</span><span class="mord mathnormal">x</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span></span></span></span></span></p><p>è¿™ä¸ªå‡½æ•°çš„å½¢çŠ¶è¯·<a href="https://en.wikipedia.org/wiki/Sigmoid_function" target="_blank" rel="noopener noreferrer">è‡ªè¡Œç™¾åº¦</a></p><p><code>W</code> å’Œ <code>b</code> æ˜¯æˆ‘ä»¬æ¥ä¸‹æ¥çš„å­¦ä¹ ç›®æ ‡ï¼ŒW ä¸ºæƒå€¼çŸ©é˜µï¼ˆWeightsï¼‰ï¼Œb ä¸ºåç½®é‡ï¼ˆBiasï¼Œä½“ç°åœ¨å›¾åƒä¸Šåˆå«æˆªè·ï¼‰ã€‚</p><p>æˆ‘ä»¬ä½¿ç”¨çš„æŸå¤±å‡½æ•°ä¸ºï¼š</p><p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>J</mi><mo stretchy="false">(</mo><mi>Î¸</mi><mo stretchy="false">)</mo><mo>=</mo><mo>âˆ’</mo><mfrac><mn>1</mn><mi>m</mi></mfrac><mrow><mo fence="true">[</mo><munderover><mo>âˆ‘</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>m</mi></munderover><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><msub><mi>h</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><msup><mi>y</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mi>log</mi><mo>â¡</mo><mo stretchy="false">(</mo><mn>1</mn><mo>âˆ’</mo><msub><mi>h</mi><mi>Î¸</mi></msub><mo stretchy="false">(</mo><msup><mi>x</mi><mrow><mo stretchy="false">(</mo><mi>i</mi><mo stretchy="false">)</mo></mrow></msup><mo stretchy="false">)</mo><mo stretchy="false">)</mo><mo fence="true">]</mo></mrow></mrow><annotation encoding="application/x-tex">J(Î¸) = -\frac{1}{m} \left[ \sum_{i=1}^m y^{(i)}\log(h_\theta(x^{(i)})) + (1 - y^{(i)})\log(1 - h_\theta(x^{(i)})) \right] </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.09618em;">J</span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.02778em;">Î¸</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:3.0277em;vertical-align:-1.2777em;"></span><span class="mord">âˆ’</span><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.3214em;"><span style="top:-2.314em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathnormal">m</span></span></span><span style="top:-3.23em;"><span class="pstrut" style="height:3em;"></span><span class="frac-line" style="border-bottom-width:0.04em;"></span></span><span style="top:-3.677em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord">1</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.686em;"><span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">[</span></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6514em;"><span style="top:-1.8723em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">1</span></span></span></span><span style="top:-3.05em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">âˆ‘</span></span></span><span style="top:-4.3em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">m</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:1.2777em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">))</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord">1</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">âˆ’</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mord"><span class="mord mathnormal">h</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight" style="margin-right:0.02778em;">Î¸</span></span></span></span><span class="vlist-s">â€‹</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.938em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mopen mtight">(</span><span class="mord mathnormal mtight">i</span><span class="mclose mtight">)</span></span></span></span></span></span></span></span></span><span class="mclose">))</span><span class="mclose delimcenter" style="top:0em;"><span class="delimsizing size4">]</span></span></span></span></span></span></span></p><p>ç”±äºæˆ‘ä»¬çš„æ•°æ®é›†åªæœ‰ä¸¤ä¸ªç‰¹å¾ï¼Œå› æ­¤ä¸ç”¨æ‹…å¿ƒè¿‡æ‹Ÿåˆï¼Œæ‰€ä»¥æŸå¤±å‡½æ•°é‡Œçš„æ­£è§„åŒ–é¡¹å°±ä¸è¦äº†ğŸ˜Œã€‚</p><p>é¦–å…ˆæˆ‘ä»¬ç”¨ TensorFlow å®šä¹‰ä¸¤ä¸ªå˜é‡ç”¨æ¥å­˜æ”¾æˆ‘ä»¬çš„è®­ç»ƒç”¨æ•°æ®ï¼š</p><div class="language-python"><pre><code><span class="token comment"># æ•°æ®é›†</span>
X <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
y <span class="token operator">=</span> tf<span class="token punctuation">.</span>placeholder<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
</code></pre></div><p>è¿™é‡Œçš„Xå’Œyä¸æ˜¯ä¸€èˆ¬çš„å˜é‡ï¼Œè€Œæ˜¯ä¸€ä¸ª <code>placeholder(å ä½ç¬¦)</code>ï¼Œæ„å‘³ç€è¿™ä¸¤ä¸ªå˜é‡çš„å€¼æ˜¯æœªæŒ‡å®šçš„ï¼Œç›´åˆ°ä½ å¼€å§‹è®­ç»ƒæ¨¡å‹æ—¶æ‰éœ€è¦å°†ç»™å®šçš„æ•°æ®èµ‹å€¼ç»™å˜é‡ã€‚</p><p>æ¥ç€æˆ‘ä»¬å†å®šä¹‰å‡ºæˆ‘ä»¬è¦è®­ç»ƒçš„ <code>W</code> å’Œ <code>b</code>ï¼š</p><div class="language-python"><pre><code><span class="token comment"># è®­ç»ƒç›®æ ‡</span>
W <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span>tf<span class="token punctuation">.</span>zeros<span class="token punctuation">(</span><span class="token punctuation">[</span>feature_num<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
b <span class="token operator">=</span> tf<span class="token punctuation">.</span>Variable<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">.9</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
</code></pre></div><p>è¿™é‡Œä»–ä»¬çš„ç±»å‹ä¸º <code>Variable(å˜é‡)</code>ï¼Œæ„å‘³ç€è¿™ä¸¤ä¸ªå˜é‡å°†åœ¨è®­ç»ƒè¿­ä»£çš„è¿‡ç¨‹ä¸­ä¸æ–­åœ°å˜åŒ–ï¼Œæœ€ç»ˆå–å¾—æˆ‘ä»¬æœŸæœ›çš„å€¼ã€‚å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬å°† <code>W</code> çš„åˆå§‹å€¼è®¾ä¸ºäº† <code>feature_num</code> ç»´çš„0å‘é‡ï¼Œå°† <code>b</code> åˆå§‹å€¼è®¾ä¸ºäº† <code>-0.9</code>ï¼ˆéšä¾¿è®¾çš„ï¼Œä¸è¦ä»‹æ„ğŸ˜¶ï¼‰</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬è¦ç”¨ TensorFlow çš„æ–¹å¼å°†æŸå¤±å‡½æ•°è¡¨è¾¾å‡ºæ¥ï¼š</p><div class="language-python"><pre><code>db <span class="token operator">=</span> tf<span class="token punctuation">.</span>matmul<span class="token punctuation">(</span>X<span class="token punctuation">,</span> tf<span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>W<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">+</span> b
hyp <span class="token operator">=</span> tf<span class="token punctuation">.</span>sigmoid<span class="token punctuation">(</span>db<span class="token punctuation">)</span>

cost0 <span class="token operator">=</span> y <span class="token operator">*</span> tf<span class="token punctuation">.</span>log<span class="token punctuation">(</span>hyp<span class="token punctuation">)</span>
cost1 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> y<span class="token punctuation">)</span> <span class="token operator">*</span> tf<span class="token punctuation">.</span>log<span class="token punctuation">(</span><span class="token number">1</span> <span class="token operator">-</span> hyp<span class="token punctuation">)</span>
cost <span class="token operator">=</span> <span class="token punctuation">(</span>cost0 <span class="token operator">+</span> cost1<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token operator">-</span>sample_num
loss <span class="token operator">=</span> tf<span class="token punctuation">.</span>reduce_sum<span class="token punctuation">(</span>cost<span class="token punctuation">)</span>
</code></pre></div><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘è¡¨è¾¾æŸå¤±å‡½æ•°æ˜¯åˆ†ä¸‰æ­¥è¿›è¡Œçš„ï¼šå…ˆåˆ†åˆ«å°†æ±‚å’Œå†…çš„ä¸¤éƒ¨åˆ†è¡¨ç¤ºå‡ºæ¥ï¼Œå†å°†å®ƒä»¬åŠ å’Œå¹¶å’Œå¤–é¢çš„å¸¸æ•°<code>m</code>è¿›è¡Œè¿ç®—ï¼Œæœ€åå¯¹è¿™ä¸ªå‘é‡è¿›è¡Œæ±‚å’Œï¼Œä¾¿å¾—åˆ°äº†æŸå¤±å‡½æ•°çš„å€¼ã€‚</p><p>æ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬è¦å®šä¹‰ä½¿ç”¨çš„ä¼˜åŒ–æ–¹æ³•ï¼š</p><div class="language-python"><pre><code>optimizer <span class="token operator">=</span> tf<span class="token punctuation">.</span>train<span class="token punctuation">.</span>GradientDescentOptimizer<span class="token punctuation">(</span><span class="token number">0.001</span><span class="token punctuation">)</span>
train <span class="token operator">=</span> optimizer<span class="token punctuation">.</span>minimize<span class="token punctuation">(</span>loss<span class="token punctuation">)</span>
</code></pre></div><p>å…¶ä¸­ï¼Œç¬¬ä¸€æ­¥æ˜¯é€‰å–ä¼˜åŒ–å™¨ï¼Œè¿™é‡Œæˆ‘ä»¬é€‰æ‹©æ¢¯åº¦ä¸‹é™æ–¹æ³•ï¼›ç¬¬äºŒæ­¥æ˜¯ä¼˜åŒ–ç›®æ ‡ï¼Œä»å‡½æ•°åå­—é¡¾åæ€ä¹‰ï¼Œæˆ‘ä»¬çš„ä¼˜åŒ–ç›®æ ‡æ˜¯ä½¿å¾—æŸå¤±å‡½æ•°çš„å€¼æœ€å°åŒ–ã€‚</p><p><strong><code>æ³¨æ„</code></strong>ï¼šæ­¤å¤„çš„å­¦ä¹ ç‡ï¼ˆ0.001ï¼‰åº”å½“å°½å¯èƒ½å°ï¼Œå¦åˆ™å¯èƒ½ä¼šå‡ºç°<a href="https://stackoverflow.com/questions/35106101/why-does-my-tensorflow-convnet-attempted-training-result-in-nan-gradients" target="_blank" rel="noopener noreferrer">æŸå¤±è®¡ç®—ä¸­å‡ºç° <em>log(0)</em></a>çš„é—®é¢˜ã€‚</p><h3 id="è®­ç»ƒ" tabindex="-1">è®­ç»ƒ <a class="header-anchor" href="#è®­ç»ƒ" aria-hidden="true">#</a></h3><p>ä¸Šé¢çš„å·¥ä½œåšå®Œä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥å¼€å§‹è®­ç»ƒæˆ‘ä»¬çš„æ¨¡å‹äº†ã€‚</p><p>åœ¨ TensorFlow ä¸­ï¼Œé¦–å…ˆè¦å°†ä¹‹å‰å®šä¹‰çš„<code>Variable</code>åˆå§‹åŒ–ï¼š</p><div class="language-python"><pre><code>init <span class="token operator">=</span> tf<span class="token punctuation">.</span>global_variables_initializer<span class="token punctuation">(</span><span class="token punctuation">)</span>
sess <span class="token operator">=</span> tf<span class="token punctuation">.</span>Session<span class="token punctuation">(</span><span class="token punctuation">)</span>
sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>init<span class="token punctuation">)</span>
</code></pre></div><p>åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬çœ‹åˆ°å‡ºç°äº†ä¸€ä¸ª<code>tf.Session()</code>ï¼Œé¡¾åæ€ä¹‰æ˜¯<code>ä¼šè¯</code>ï¼Œå³ä»»åŠ¡æ‰§è¡Œçš„ä¸»ä½“ã€‚æˆ‘ä»¬ä¸Šé¢å®šä¹‰äº†ä¸€å †ä¸œè¥¿ï¼Œåªæ˜¯ä¸€ä¸ªæ¨¡å‹ä¸ºäº†å¾—åˆ°ç»“æœè€Œéœ€è¦çš„æ‰§è¡Œæ­¥éª¤å’Œæ¡†æ¶ï¼Œä¸€ä¸ªç±»ä¼¼<code>æµç¨‹å›¾</code>çš„ä¸œè¥¿ï¼Œå…‰æœ‰æµç¨‹å›¾è¿˜ä¸å¤Ÿï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªä¸»ä½“æ¥å®é™…åœ°è¿è¡Œå®ƒï¼Œè¿™å°±æ˜¯<code>Session</code>çš„ä½œç”¨ã€‚</p><h3 id="ç‰¹åˆ«æç¤º" tabindex="-1"><code>----------ç‰¹åˆ«æç¤º----------</code> <a class="header-anchor" href="#ç‰¹åˆ«æç¤º" aria-hidden="true">#</a></h3><p>å¦‚æœä½ æ˜¯ä½¿ç”¨ GPU ç‰ˆ TensorFlow çš„è¯ï¼Œå¹¶ä¸”ä½ æƒ³åœ¨æ˜¾å¡é«˜å ç”¨ç‡çš„æƒ…å†µä¸‹ï¼ˆæ¯”å¦‚ç©æ¸¸æˆï¼‰è®­ç»ƒæ¨¡å‹ï¼Œé‚£ä½ è¦æ³¨æ„åœ¨åˆå§‹åŒ– <code>Session</code> çš„æ—¶å€™<a href="https://stackoverflow.com/questions/34199233/how-to-prevent-tensorflow-from-allocating-the-totality-of-a-gpu-memory/34200194" target="_blank" rel="noopener noreferrer">ä¸ºå…¶åˆ†é…å›ºå®šæ•°é‡çš„æ˜¾å­˜</a>ï¼Œå¦åˆ™å¯èƒ½ä¼šåœ¨å¼€å§‹è®­ç»ƒçš„æ—¶å€™ç›´æ¥æŠ¥é”™é€€å‡ºï¼š</p><div class="language-"><pre><code>2017-06-27 20:39:21.955486: E c:\tf_jenkins\home\workspace\release-win\m\windows-gpu\py\35\tensorflow\stream_executor\cuda\cuda_blas.cc:365] failed to create cublas handle: CUBLAS_STATUS_ALLOC_FAILED
Traceback (most recent call last):
  File &quot;C:\Users\DYZ\Anaconda3\envs\tensorflow\lib\site-packages\tensorflow\python\client\session.py&quot;, line 1139, in _do_call
    return fn(*args)
  File &quot;C:\Users\DYZ\Anaconda3\envs\tensorflow\lib\site-packages\tensorflow\python\client\session.py&quot;, line 1121, in _run_fn
    status, run_metadata)
  File &quot;C:\Users\DYZ\Anaconda3\envs\tensorflow\lib\contextlib.py&quot;, line 66, in __exit__
    next(self.gen)
  File &quot;C:\Users\DYZ\Anaconda3\envs\tensorflow\lib\site-packages\tensorflow\python\framework\errors_impl.py&quot;, line 466, in raise_exception_on_not_ok_status
    pywrap_tensorflow.TF_GetCode(status))
tensorflow.python.framework.errors_impl.InternalError: Blas GEMV launch failed:  m=2, n=100
         [[Node: MatMul = MatMul[T=DT_FLOAT, transpose_a=false, transpose_b=false, _device=&quot;/job:localhost/replica:0/task:0/gpu:0&quot;](_arg_Placeholder_0_0/_3, Reshape)]]
</code></pre></div><p>è¿™æ—¶ä½ éœ€è¦ç”¨ä¸‹é¢çš„æ–¹æ³•åˆ›å»º <code>Session</code>ï¼š</p><div class="language-python"><pre><code>gpu_options <span class="token operator">=</span> tf<span class="token punctuation">.</span>GPUOptions<span class="token punctuation">(</span>per_process_gpu_memory_fraction<span class="token operator">=</span><span class="token number">0.333</span><span class="token punctuation">)</span>
sess <span class="token operator">=</span> tf<span class="token punctuation">.</span>Session<span class="token punctuation">(</span>config<span class="token operator">=</span>tf<span class="token punctuation">.</span>ConfigProto<span class="token punctuation">(</span>gpu_options<span class="token operator">=</span>gpu_options<span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>è¿™é‡Œçš„<code>0.333</code>å°±æ˜¯å ä½ æ€»æ˜¾å­˜çš„ä»½é¢ã€‚</p><h3 id="end-ç‰¹åˆ«æç¤º" tabindex="-1"><code>----------End ç‰¹åˆ«æç¤º----------</code> <a class="header-anchor" href="#end-ç‰¹åˆ«æç¤º" aria-hidden="true">#</a></h3><p>ä¸‹é¢å°±æ˜¯ç”¨æˆ‘ä»¬çš„æ•°æ®é›†æ¥å¯¹æ¨¡å‹è¿›è¡Œè®­ç»ƒäº†ï¼š</p><div class="language-python"><pre><code>feed_dict <span class="token operator">=</span> <span class="token punctuation">{</span>X<span class="token punctuation">:</span> train_X<span class="token punctuation">,</span> y<span class="token punctuation">:</span> train_y<span class="token punctuation">}</span>

<span class="token keyword">for</span> step <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1000000</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>train<span class="token punctuation">,</span> <span class="token punctuation">{</span>X<span class="token punctuation">:</span> train_X<span class="token punctuation">,</span> y<span class="token punctuation">:</span> train_y<span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> step <span class="token operator">%</span> <span class="token number">100</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>step<span class="token punctuation">,</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>W<span class="token punctuation">)</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> sess<span class="token punctuation">.</span>run<span class="token punctuation">(</span>b<span class="token punctuation">)</span><span class="token punctuation">.</span>flatten<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
</code></pre></div><p>é¦–å…ˆè®²è¦ä¼ å…¥çš„æ•°æ®å­˜æ”¾åˆ°ä¸€ä¸ªå˜é‡ä¸­ï¼Œåœ¨è®­ç»ƒæ¨¡å‹æ—¶ä¼ å…¥ <code>sess.run()</code>ï¼›æˆ‘ä»¬è¿›è¡Œ 10000 æ¬¡è®­ç»ƒï¼Œæ¯éš” 100 æ¬¡è¾“å‡ºä¸€æ¬¡å½“å‰çš„ç›®æ ‡å‚æ•° <code>W, b</code>ã€‚</p><p>åˆ°è¿™é‡Œï¼Œè®­ç»ƒä»£ç çš„éƒ¨åˆ†å°±å®Œæˆäº†ï¼Œä½ å¯ä»¥ä½¿ç”¨ä½ è‡ªå·±çš„ python å‘½ä»¤æ¥è¿è¡Œäº†ã€‚å¦‚æœä½ ä¸¥æ ¼æŒ‰ç…§ä¸Šé¢çš„ä»£ç åšäº†ï¼Œä¸å‡ºç°é”™è¯¯ï¼Œä½ ç°åœ¨åº”è¯¥å¯ä»¥çœ‹åˆ°æ§åˆ¶å°é‡Œå·²ç»å¼€å§‹ä¸æ–­è¾“å‡ºè®­ç»ƒçŠ¶æ€äº†ï¼š</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcly1fh0l0l38ttj30kv0cv0w6.jpg" alt=""></p><h3 id="å›¾å½¢åŒ–è¡¨ç¤ºç»“æœ" tabindex="-1">å›¾å½¢åŒ–è¡¨ç¤ºç»“æœ <a class="header-anchor" href="#å›¾å½¢åŒ–è¡¨ç¤ºç»“æœ" aria-hidden="true">#</a></h3><p>å½“è®­ç»ƒç»“æŸåï¼Œä½ å¯ä»¥å¾—åˆ°ä¸€ä¸ª <code>W</code>ï¼Œå’Œä¸€ä¸ª <code>b</code>ï¼Œè¿™æ ·æˆ‘ä»¬å¯ä»¥å°†æ•°æ®é›†å’Œæ‹Ÿåˆçš„ç»“æœé€šè¿‡å›¾è¡¨ç›´è§‚åœ°å±•ç°å‡ºæ¥ã€‚</p><p>å°±åœ¨å†™ä½œçš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ç”¨ä¸Šé¢çš„ä»£ç è®­ç»ƒå‡ºäº†ä¸€ä¸ªç»“æœï¼š</p><p><img src="https://ws1.sinaimg.cn/large/006tKfTcly1fh0l0w2j86j30l3011dfu.jpg" alt=""></p><p>æˆ‘ä»¬å°†å…¶ç›´æ¥å†™å…¥ä»£ç ï¼Œå³ï¼š</p><div class="language-python"><pre><code>w <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token number">0.12888144</span><span class="token punctuation">,</span> <span class="token number">0.12310864</span><span class="token punctuation">]</span>
b <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">15.47322273</span>
</code></pre></div><p>ä¸‹é¢æˆ‘ä»¬å…ˆå°†æ•°æ®é›†è¡¨ç¤ºåœ¨å›¾è¡¨ä¸Šï¼ˆx1ä¸ºæ¨ªè½´ï¼Œx2ä¸ºçºµè½´ï¼‰ï¼š</p><div class="language-python"><pre><code>x1 <span class="token operator">=</span> train_data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span>
x2 <span class="token operator">=</span> train_data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span>
y <span class="token operator">=</span> train_data<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span><span class="token punctuation">]</span>

<span class="token keyword">for</span> x1p<span class="token punctuation">,</span> x2p<span class="token punctuation">,</span> yp <span class="token keyword">in</span> <span class="token builtin">zip</span><span class="token punctuation">(</span>x1<span class="token punctuation">,</span> x2<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">if</span> yp <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x1p<span class="token punctuation">,</span> x2p<span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">&#39;x&#39;</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">&#39;r&#39;</span><span class="token punctuation">)</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>x1p<span class="token punctuation">,</span> x2p<span class="token punctuation">,</span> marker<span class="token operator">=</span><span class="token string">&#39;o&#39;</span><span class="token punctuation">,</span> c<span class="token operator">=</span><span class="token string">&#39;g&#39;</span><span class="token punctuation">)</span>
</code></pre></div><p>å…¶ä¸­ï¼Œæˆ‘ä»¬ç”¨ <code>çº¢è‰²çš„x</code> ä»£è¡¨ <code>æ²¡æœ‰è¢«å½•å–</code>ï¼Œç”¨ <code>ç»¿è‰²çš„o</code> ä»£è¡¨ <code>è¢«å½•å–</code>ã€‚</p><p>å…¶æ¬¡æˆ‘ä»¬å°†è®­ç»ƒå¾—å‡ºçš„å†³ç­–è¾¹ç•Œ <code>XW + b = 0</code> è¡¨ç¤ºåˆ°å›¾è¡¨ä¸Šï¼š</p><div class="language-python"><pre><code><span class="token comment"># æ ¹æ®å‚æ•°å¾—åˆ°ç›´çº¿</span>
x <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span>
y <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> x<span class="token punctuation">:</span>
    y<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">(</span>i <span class="token operator">*</span> <span class="token operator">-</span>w<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">-</span> b<span class="token punctuation">)</span> <span class="token operator">/</span> w<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    
plt<span class="token punctuation">.</span>plot<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span>
</code></pre></div><p>æ­¤æ—¶ï¼Œå¦‚æœä½ çš„ä»£ç æ²¡é”™çš„è¯ï¼Œå†æ¬¡è¿è¡Œï¼Œä½ å°†å¾—åˆ°å¦‚ä¸‹ç»“æœï¼š</p><p><img src="https://ws2.sinaimg.cn/large/006tKfTcly1fh0l1ktu4kj30m80iwmyq.jpg" alt=""></p><p>å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡è®­ç»ƒå¾—å‡ºçš„å‚æ•°åˆ’å‡ºä¸€æ¡ç›´çº¿ï¼Œéå¸¸åˆé€‚åœ°å°†ä¸¤ç§ä¸åŒçš„æ•°æ®æ ·ä¾‹åŒºåˆ†å¼€æ¥ã€‚</p><p>åˆ°æ­¤ï¼Œä¸€ä¸ªå®Œæ•´çš„ç®€å•çš„é€»è¾‘å›å½’æ¨¡å‹å°±å®ç°å®Œæ¯•äº†ï¼Œå¸Œæœ›é€šè¿‡è¿™ç¯‡æ–‡ç« ï¼Œèƒ½è®©å„ä½çœ‹å®˜å¯¹åœ¨ <code>TensorFlow</code> ä¸­æœºå™¨å­¦ä¹ æ¨¡å‹çš„å®ç°æœ‰ä¸€ä¸ªåˆæ­¥çš„äº†è§£ã€‚æœ¬äººä¹Ÿåœ¨åˆæ­¥å­¦ä¹ å½“ä¸­ï¼Œå¦‚æœ‰ä¸å½“ä¹‹å¤„æ¬¢è¿åœ¨è¯„è®ºåŒºæ‹ç –ï¼Œåœ¨å®ç°ä»¥ä¸Šä»£ç çš„è¿‡ç¨‹ä¸­å¦‚æœé‡åˆ°ä»€ä¹ˆé—®é¢˜ä¹Ÿè¯·åœ¨è¯„è®ºåŒºéšæ„å¼€ç«ã€‚</p></div></div></div><div class="comment mt-40"><div id="vcomment"></div></div></div><!----><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" aria-hidden="true" class="hidden sm:block fixed sm:right-8 sm:bottom-8 w-10 h-10 text-gray-600 hover:text-sky-800 cursor-pointer"><path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-8.707l-3-3a1 1 0 00-1.414 0l-3 3a1 1 0 001.414 1.414L9 9.414V13a1 1 0 102 0V9.414l1.293 1.293a1 1 0 001.414-1.414z" clip-rule="evenodd"></path></svg><!--]--></div><footer class="text-center align-bottom text-gray-500 font-normal text-lg py-3 mt-auto border border-t-gray-200"><span>Powered by </span><a href="https://github.com/dyzdyz010/vitepress-theme-oblivion" target="_blank" class="text-sky-600 hover:text-sky-700"> vitepress-theme-oblivion</a><span class="mx-3">|</span><span>Copyright Â© </span><a href="https://github.com/dyzdyz010" target="_blank" title="ä½œè€…" class="text-sky-600 hover:text-sky-700">dyzdyz010</a><span class="mx-3">|</span><span>2022 - 2022</span><span class="mx-3">|</span><span>MIT License</span></footer></div></div>
    <script>__VP_HASH_MAP__ = JSON.parse("{\"about.md\":\"acbbe5ad\",\"collections.md\":\"fd7103b4\",\"index.md\":\"c12eb994\",\"posts_blog-meta_2022_vitepress-theme-oblivion.md\":\"acbb221d\",\"posts_blog-meta_20220520-post-template.md\":\"649a867e\",\"posts_life_2017_2017-year-review.md\":\"005e606b\",\"posts_life_2017_check-in-20171027.md\":\"31f8ad45\",\"posts_life_2017_ss-module-for-surge.md\":\"6c0e1df9\",\"posts_life_2019_2019-year-review.md\":\"89e578fb\",\"posts_life_2020_new-theme-wonderland.md\":\"6ce7c0c1\",\"posts_life_2021_2021-year-review.md\":\"5b5f7a14\",\"posts_life_2021_20210507-blog-new-style.md\":\"2575f2d9\",\"posts_mmo-server-from-scratch_2022_20220608-mmo-server-from-scratch(0)-introduction.md\":\"d271ee4b\",\"posts_mmo-server-from-scratch_2022_20220610-mmo-server-from-scratch(1)-beacon-server.md\":\"fa888aca\",\"posts_mmo-server-from-scratch_2022_20221016-mmo-server-from-scratch(2)-gate-server.md\":\"52d84268\",\"posts_mmo-server-from-scratch_2022_20221016-mmo-server-from-scratch(3)-scene-server-aoi.md\":\"5244459f\",\"posts_mmo-server-from-scratch_2022_20221016-mmo-server-from-scratch(4)-scene-server-aoi-data-structure.md\":\"d1a0824c\",\"posts_mmo-server-from-scratch_2022_20221016-mmo-server-from-scratch(5)-scene-server-aoi-supervision-tree.md\":\"51641030\",\"posts_productivity_2018_enable-latex-export-logging-in-org-mode.md\":\"4cdc5f4f\",\"posts_productivity_2020_bulletproof-task-management-priority-formula.md\":\"a4b0a0ff\",\"posts_products_2017_wonderland-ghost-theme.md\":\"5e1b46f9\",\"posts_products_2018_wwdc-2018-keynot-review.md\":\"2987df03\",\"posts_recommendations_2017_acg-wallpaper-recommendation-0.md\":\"7172a448\",\"posts_recommendations_2017_europe-folk-music-playlist.md\":\"06e31597\",\"posts_study_2017_ml-bp-neural-network-review.md\":\"cb630e76\",\"posts_study_2017_ml-course-summary-review.md\":\"c30a088d\",\"posts_study_2017_ml-logistic-regression-review.md\":\"e9647cc2\",\"posts_study_2017_music-theory-pentatonic-scale.md\":\"f459c8fa\",\"posts_study_2018_quicksort-review.md\":\"d992f04a\",\"posts_thoughts_2021_20210520.md\":\"946c52de\",\"posts_thoughts_2022_20220520-thoughts-on-medical.md\":\"237e798a\",\"posts_thoughts_2022_20220902-recent-thoughts.md\":\"ba005bd2\",\"posts_tutorials_2017_logistic-regression-model-with-tensorflow-from-scratch.md\":\"8cc97dee\",\"posts_tutorials_2017_migrating-ghost-to-1-0-on-centos7.md\":\"86b97fa6\",\"posts_tutorials_2018_origin-download-speedup.md\":\"670f843c\",\"posts_tutorials_2018_set-up-flarum-from-scratch.md\":\"6675e685\",\"posts_tutorials_2018_using-virtualenv-in-jupyter-notebook.md\":\"7762e84b\",\"posts_tutorials_2019_hugo-with-github-pages.md\":\"adb061c4\",\"posts_tutorials_2019_install-kbengine-on-ubuntu-18-04-lts.md\":\"9b1b515a\",\"posts_tutorials_2020_wsl-elixir-observer.md\":\"af1dc31a\",\"posts_tutorials_2021_rhel-8-with-sas2008-raid-controllers.md\":\"5128ce1b\",\"posts_tutorials_2021_windows-git-proxy.md\":\"78a1f861\",\"posts_tutorials_2021_wsl2-firewall-fix.md\":\"176bd889\",\"posts_tutorials_2022_add-protobuf-to-ue5-project.md\":\"66319268\",\"posts_weibo_2022_20220620-about-weibo.md\":\"ab7081bd\",\"tags.md\":\"d11cd865\"}")</script>
    <script type="module" async src="/assets/app.7001bd85.js"></script>
    
  </body>
</html>